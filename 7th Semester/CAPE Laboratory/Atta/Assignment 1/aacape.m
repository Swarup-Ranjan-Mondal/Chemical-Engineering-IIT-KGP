a = 1.5;
T11(1) =0; T21(1)=0;T31(1)=0; T12(1)=0; T22(1)=0; T32(1)=0; T13(1)=0;  T23(1)=0; T33(1)=0;
T01 = 75; T02=75; T03=75; T10=0; T20=0; T30=0; T41=50; T42=50; T43=50; T14=100; T24=100; T34=100;
b=1;

for i=1:100
T11(i+1) = (1-a)*T11(i) + (a)*(((T21(i) + T01)/(b^2) + (T12(i) + T10))/((2/b^2) + 2));
T21(i+1) = (1-a)*T21(i) + (a)*(((T31(i) + T11(i+1))/(b^2) + (T22(i) + T20))/((2/b^2) + 2));
T31(i+1) = (1-a)*T31(i) + (a)*(((T41 + T21(i+1))/(b^2) + (T32(i) + T30))/((2/b^2) +2));
T12(i+1) = (1-a)*T12(i) + (a)*(((T22(i) + T02)/(b^2) + (T13(i) + T11(i+1)))/((2/b^2) + 2));
T22(i+1) = (1-a)*T22(i) + (a)*(((T32(i) + T12(i+1))/(b^2) + (T23(i) + T21(i+1)))/((2/b^2) + 2));
T32(i+1) = (1-a)*T32(i) + (a)*(((T42 + T22(i+1))/(b^2) + (T33(i) + T31(i+1)))/((2/b^2) + 2));
T13(i+1) = (1-a)*T13(i) + (a)*(((T23(i) + T03)/(b^2) + (T14 + T12(i+1)))/((2/b^2) + 2));
T23(i+1) = (1-a)*T23(i) + (a)*(((T33(i) + T13(i+1))/(b^2) + (T24 + T22(i+1)))/((2/b^2) + 2));
T33(i+1) = (1-a)*T33(i) + (a)*(((T43 + T23(i+1))/(b^2) + (T34 + T32(i+1)))/((2/b^2) + 2));

if abs((T11(i+1) - T11(i))/T11(i+1)) <= 0.01 & abs((T21(i+1) - T21(i))/T21(i+1)) <= 0.01 & abs((T31(i+1) - T31(i))/T31(i+1)) <= 0.01 & abs((T12(i+1) - T12(i))/T12(i+1)) <= 0.01 abs((T22(i+1) - T22(i))/T22(i+1)) <= 0.01 & abs(((T32(i+1) - T32(i)))/T32(i+1)) <= 0.01 & abs((T13(i+1) - T13(i))/T13(i+1)) <= 0.01 & abs((T23(i+1) - T23(i))/T23(i+1)) <= 0.01 & abs((T33(i+1) - T33(i))/T33(i+1)) <= 0.01
    break;
end

end
